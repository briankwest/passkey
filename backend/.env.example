# Database Configuration
DATABASE_URL=postgresql://postgres:password@localhost:5432/passkey

# Security Keys (CHANGE THESE IN PRODUCTION!)
SESSION_SECRET=your-session-secret-here-change-in-production
JWT_SECRET=your-jwt-secret-here-change-in-production

# Server Configuration
PORT=5001
NODE_ENV=development

# WebAuthn/Passkey Configuration
RP_NAME=Passkey
RP_ID=localhost
ORIGIN=http://localhost:3000
# User verification: 'required' (always require PIN), 'preferred' (optional PIN), 'discouraged' (no PIN)
USER_VERIFICATION=preferred

# Application Settings
APP_NAME=Passkey
APP_URL=http://localhost:3000

# Email Configuration (Optional - logs to console if not configured)
# For production, sign up at https://www.mailgun.com/
MAILGUN_API_KEY=
MAILGUN_DOMAIN=
MAILGUN_FROM_EMAIL=noreply@your-domain.com
MAILGUN_FROM_NAME=Passkey

# Email Settings
EMAIL_VERIFICATION_EXPIRY=24h
EMAIL_VERIFICATION_REQUIRED=true

# Password Reset Settings
PASSWORD_RESET_EXPIRY=1h

# Account Security Settings
# Failed login attempts before lockout
MAX_FAILED_ATTEMPTS=5
# Lockout duration in minutes
LOCKOUT_DURATION=30
# Extended lockout duration after 10+ attempts
EXTENDED_LOCKOUT_DURATION=60

# Password Policy
PASSWORD_MIN_LENGTH=12
PASSWORD_MAX_LENGTH=128
PASSWORD_MIN_SCORE=3
PASSWORD_HISTORY_LIMIT=10

# TOTP/2FA Settings
TOTP_WINDOW=1
BACKUP_CODE_COUNT=8
BACKUP_CODE_LENGTH=10

# CORS Configuration (comma-separated origins)
ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# Rate Limiting (requests per minute)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Logging Level (error, warn, info, debug)
LOG_LEVEL=info

# Session Configuration
SESSION_COOKIE_NAME=passkey_session
SESSION_COOKIE_MAX_AGE=604800000
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax

# Development/Testing
# Set to true to disable email sending and log to console instead
DISABLE_EMAIL_SENDING=false